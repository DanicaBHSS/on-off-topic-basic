<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>On-Topic Off-Topic Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@700&display=swap');

        body {
            font-family: 'Comic Neue', cursive;
            background-color: #89cff0;
            color: #333;
            text-align: center;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            overflow: hidden;
        }

        #game-container {
            max-width: 800px;
            width: 100%;
            margin: auto;
            background-color: #fff;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        h1, h2 {
            font-family: 'Fredoka One', cursive;
        }

        h1 {
            color: #005a9c;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
        }

        h2 {
            color: #005a9c;
            font-size: clamp(1.1rem, 4vw, 1.4rem);
        }
        
        #intro-screen-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        #intro-main-panel {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            width: 100%;
            flex-wrap: wrap;
        }

        #monster-panel {
            position: relative;
            width: 200px;
            height: 250px;
        }
        
        #controls-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            flex: 1;
            min-width: 300px;
        }

        #topic-monster {
            width: 100%;
            height: 100%;
            transition: transform 0.2s ease;
        }
        
        #topic-monster.wiggle { animation: wiggle 0.4s ease-in-out; }
        @keyframes wiggle { 0%, 100% { transform: rotate(0); } 25% { transform: rotate(-3deg); } 75% { transform: rotate(3deg); } }

        .body-part-icon {
            position: absolute;
            font-size: 2.5em;
            opacity: 0;
            transform: scale(0);
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        .visible {
            opacity: 1;
            transform: scale(1);
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        @keyframes popIn { 0% { transform: scale(0); } 75% { transform: scale(1.2); } 100% { transform: scale(1); } }

        #icon-eyes { top: 35%; left: 40%; }
        #icon-mouth-emoji { top: 55%; left: 40%; }
        #icon-brain { top: 10%; left: 38%; }
        #icon-ear-left { top: 40%; left: 5%; font-size: 2em; }
        #icon-ear-right { top: 40%; left: 75%; font-size: 2em; }
        #icon-hands { top: 70%; left: 35%; font-size: 3em; }

        .floating-emoji {
            position: absolute;
            font-size: 2em;
            opacity: 0;
            pointer-events: none;
            transform-origin: center center;
        }

        .animate-grow {
            animation: growAndVanish 0.5s ease-in-out forwards;
        }

        @keyframes growAndVanish {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2.5); }
        }

        #intro-controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .intro-button {
            padding: 10px 20px;
            font-size: 1.1em;
            font-family: 'Fredoka One', cursive;
            background-color: #f0ad4e;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px #c08a3e;
            transition: all 0.1s ease-in-out;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .intro-button:active { transform: translateY(2px); box-shadow: 0 2px #c08a3e; }
        .intro-button.completed { background-color: #5cb85c; box-shadow: 0 4px #4a944a; }

        #explanation-container {
            width: 100%;
            text-align: left;
            font-size: 1.1em;
        }

        #cue-box {
            background-color: #e0f7fa;
            border: 2px solid #00796b;
            border-radius: 10px;
            padding: 15px;
            font-weight: bold;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        #example-box {
            background-color: #fff;
            border: 2px dashed #00796b;
            border-top: none;
            border-radius: 0 0 10px 10px;
            padding: 0 15px;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.5s ease-out, padding 0.5s ease-out;
        }
        
        #example-box.visible {
            padding: 15px;
            max-height: 200px;
            opacity: 1;
        }

        #game-screen { display: none; }
        #topic-box { background-color: #ffd700; padding: 15px; border-radius: 10px; margin: 20px auto; font-size: clamp(1rem, 4vw, 1.2rem); font-weight: bold; }
        #scenario-box { font-size: clamp(1.2rem, 5vw, 1.5rem); min-height: 80px; margin: 20px 0; display: flex; align-items: center; justify-content: center; }
        
        #target-container { position: relative; width: 250px; height: 250px; margin: 20px auto; }
        #target-svg { width: 100%; height: 100%; }
        
        #dart {
            position: absolute;
            font-size: 4.5em; /* üéØ emoji */
            top: 50%;
            left: -100px;
            transform: translateY(-50%);
            transition: all 0.6s cubic-bezier(0.5, 0, 0.9, 0.5);
            line-height: 1;
        }
        
        #dart.hit-bullseye {
            left: calc(50% - 36px);
            top: calc(50% - 36px);
        }
        
        #dart.hit-outside {
            left: calc(50% - 36px);
            top: 5px; /* Lands in the red ring */
        }

        .button { padding: 15px 25px; font-size: clamp(1rem, 4vw, 1.2rem); font-family: 'Fredoka One', cursive; border-radius: 10px; border: none; cursor: pointer; margin: 10px 5px; transition: transform 0.2s, box-shadow 0.2s; color: white; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .button:hover { transform: translateY(-2px); box-shadow: 0 6px 8px rgba(0,0,0,0.15); }
        .button:active { transform: translateY(1px); }
        #start-button { background-color: #4CAF50; display: none; margin-top: 15px; }
        #on-topic-btn { background-color: #4682b4; }
        #off-topic-btn { background-color: #ff6347; }
        #next-btn { background-color: #9370db; display: none; }
        #restart-btn { background-color: #f0ad4e; display: none; }
        footer { margin-top: 30px; font-size: 0.9em; color: #777; font-family: sans-serif; }

    </style>
</head>
<body>

    <div id="game-container">
        <!-- INTRO SCREEN -->
        <div id="intro-screen">
            <h1>On-Topic Off-Topic</h1>
            <h2 id="intro-subtitle">What does it mean to be ON-TOPIC?</h2>
            <div id="intro-screen-content">
                <div id="intro-main-panel">
                    <div id="monster-panel">
                        <svg id="topic-monster" viewBox="0 0 100 100">
                            <path d="M50 95C25.1 95 5 74.9 5 50S25.1 5 50 5s45 20.1 45 45-20.1 45-45 45z" fill="#a8e6cf"/>
                        </svg>
                        <div id="icon-eyes" class="body-part-icon">üëÄ</div>
                        <div id="icon-mouth-emoji" class="body-part-icon">üëÑüí¨</div>
                        <div id="icon-brain" class="body-part-icon">üß†</div>
                        <div id="icon-ear-left" class="body-part-icon">üëÇ</div>
                        <div id="icon-ear-right" class="body-part-icon">üëÇ</div>
                        <div id="icon-hands" class="body-part-icon">‚úãü§ö</div>
                    </div>
                    <div id="controls-panel">
                        <div id="explanation-container">
                            <div id="cue-box"><p>Click a button to begin!</p></div>
                            <div id="example-box"></div>
                        </div>
                        <div id="intro-controls">
                            <button class="intro-button" data-part="eyes">üëÄ Eyes</button>
                            <button class="intro-button" data-part="body">üßç Body</button>
                            <button class="intro-button" data-part="mouth">üëÑ Mouth</button>
                            <button class="intro-button" data-part="brain">üß† Brain</button>
                        </div>
                    </div>
                </div>
                <button class="button" id="start-button">Let's Play!</button>
                <div id="float-eyes" class="floating-emoji">üëÄ</div>
                <div id="float-body" class="floating-emoji">üëÇ‚úã</div>
                <div id="float-mouth" class="floating-emoji">üëÑüí¨</div>
                <div id="float-brain" class="floating-emoji">üß†</div>
            </div>
        </div>

        <!-- GAME SCREEN -->
        <div id="game-screen">
            <h1>On-Topic Target Practice</h1>
            <div id="topic-box">Topic: <span id="current-topic"></span></div>
            <div id="scenario-box"></div>
            <div id="target-container">
                <svg id="target-svg" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="50" fill="#d9534f"/><circle cx="50" cy="50" r="40" fill="#f0ad4e"/><circle cx="50" cy="50" r="30" fill="#5bc0de"/><circle cx="50" cy="50" r="20" fill="#5cb85c"/>
                </svg>
                <div id="dart">üéØ</div>
            </div>
            <div id="choice-buttons">
                <button class="button" id="on-topic-btn">On Topic</button>
                <button class="button" id="off-topic-btn">Off Topic</button>
            </div>
            <button class="button" id="next-btn">Next Question</button>
            <button class="button" id="restart-btn">Back to Main Menu</button>
        </div>

        <footer>
            Black Hills Speech Solutions
        </footer>
    </div>

    <script>
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        function playBoop() {
            if (!audioContext) return;
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + 0.2);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (error) { console.log("Could not play sound."); }
        }

        const introParts = {
            eyes: { cue: "Your eyes are ON-TOPIC when they are watching the person who is talking or looking at the topic of choice.", example: "If your friends are building a LEGO castle, your eyes are looking at the castle. That's ON-TOPIC! If your eyes are looking out the window at a bird, they are OFF-TOPIC." },
            body: { cue: "Your body is ON-TOPIC when it's turned towards the person you are talking with or facing the topic.", example: "Your body is like a friendly arrow, always pointing toward the fun! If the conversation is about a board game, your whole body is turned toward the game. That's ON-TOPIC!" },
            mouth: { cue: "Your mouth is ON-TOPIC when the words you say match the topic.", example: "Your words are like puzzle pieces. If everyone is talking about superheroes, saying 'Spider-Man is cool!' is an ON-TOPIC piece. But shouting, 'I like mashed potatoes!' is an OFF-TOPIC piece." },
            brain: { cue: "Your brain is ON-TOPIC when you are thinking about the same thing as everyone else.", example: "Your brain makes 'thought bubbles.' When your thought bubbles are about the topic, your brain is ON-TOPIC. If your thought bubble is about video games during a beach conversation, your brain is OFF-TOPIC." }
        };
        const introButtons = document.querySelectorAll('.intro-button');
        const cueBox = document.getElementById('cue-box');
        const exampleBox = document.getElementById('example-box');
        const startButton = document.getElementById('start-button');
        const topicMonster = document.getElementById('topic-monster');
        const completedParts = new Set();

        introButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (button.classList.contains('completed')) return;
                playBoop();
                const part = button.dataset.part;
                cueBox.innerHTML = `<p>${introParts[part].cue}</p>`;
                exampleBox.innerHTML = `<p>${introParts[part].example}</p>`;
                exampleBox.classList.add('visible');
                const floater = document.getElementById(`float-${part}`);
                const buttonRect = button.getBoundingClientRect();
                const gameContainerRect = document.getElementById('game-container').getBoundingClientRect();
                const startX = buttonRect.left - gameContainerRect.left + (buttonRect.width / 2) - (floater.offsetWidth / 2);
                const startY = buttonRect.top - gameContainerRect.top + (buttonRect.height / 2) - (floater.offsetHeight / 2);
                floater.style.left = `${startX}px`;
                floater.style.top = `${startY}px`;
                floater.classList.add('animate-grow');
                setTimeout(() => {
                    if (part === 'eyes') document.getElementById('icon-eyes').classList.add('visible');
                    else if (part === 'body') {
                        document.getElementById('icon-ear-left').classList.add('visible');
                        document.getElementById('icon-ear-right').classList.add('visible');
                        document.getElementById('icon-hands').classList.add('visible');
                    } else if (part === 'mouth') document.getElementById('icon-mouth-emoji').classList.add('visible');
                    else if (part === 'brain') document.getElementById('icon-brain').classList.add('visible');
                }, 300);
                setTimeout(() => { floater.classList.remove('animate-grow'); }, 500);
                button.classList.add('completed');
                completedParts.add(part);
                topicMonster.classList.add('wiggle');
                setTimeout(() => topicMonster.classList.remove('wiggle'), 400);
                if (completedParts.size === 4) { startButton.style.display = 'inline-block'; }
            });
        });

        const scenarios = [
            { topic: 'your favorite foods', scenario: 'You say, "My favorite food is pizza!"', isOnTopic: true },
            { topic: 'playing at the park', scenario: 'While your friend talks about the swings, you start talking about your new video game.', isOnTopic: false },
            { topic: 'what you did this weekend', scenario: 'You are thinking about what you want to say about your soccer game.', isOnTopic: true },
            { topic: 'books you like to read', scenario: 'Mia is talking about her favorite book, and you look at her while she talks.', isOnTopic: true },
            { topic: 'your favorite animals', scenario: 'Leo keeps kicking the leg of his chair while the group talks about animals.', isOnTopic: false },
            { topic: 'planning a class party', scenario: 'You ask, "Should we have balloons at the party?"', isOnTopic: true },
            { topic: 'building with LEGOs', scenario: 'Someone asks what you are building, and you shout, "I want a snack!"', isOnTopic: false },
            { topic: 'superheroes', scenario: 'Your body is turned away from your friends and you are looking out the window.', isOnTopic: false }
        ];
        let currentScenarioIndex = 0;
        const introScreen = document.getElementById('intro-screen');
        const gameScreen = document.getElementById('game-screen');
        const topicSpan = document.getElementById('current-topic');
        const scenarioBox = document.getElementById('scenario-box');
        const onTopicBtn = document.getElementById('on-topic-btn');
        const offTopicBtn = document.getElementById('off-topic-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const choiceButtons = document.getElementById('choice-buttons');
        const dart = document.getElementById('dart');
        
        startButton.addEventListener('click', () => { introScreen.style.display = 'none'; gameScreen.style.display = 'block'; loadScenario(); });
        
        function loadScenario() {
            if (currentScenarioIndex >= scenarios.length) {
                scenarioBox.innerHTML = "<h2>Great job! You finished the game!</h2>";
                choiceButtons.style.display = 'none';
                nextBtn.style.display = 'none';
                restartBtn.style.display = 'inline-block';
                dart.style.transition = 'none';
                dart.className = 'dart';
                return;
            }
            const currentScenario = scenarios[currentScenarioIndex];
            topicSpan.textContent = currentScenario.topic;
            scenarioBox.textContent = currentScenario.scenario;
            choiceButtons.style.display = 'block';
            nextBtn.style.display = 'none';
            onTopicBtn.disabled = false;
            offTopicBtn.disabled = false;
            dart.style.transition = 'none';
            dart.className = 'dart';
            void dart.offsetWidth;
            dart.style.transition = 'all 0.6s cubic-bezier(0.5, 0, 0.9, 0.5)';
        }
        
        function showResult() {
            onTopicBtn.disabled = true;
            offTopicBtn.disabled = true;
            const isScenarioOnTopic = scenarios[currentScenarioIndex].isOnTopic;
            
            if (isScenarioOnTopic) {
                dart.classList.add('hit-bullseye');
            } else {
                dart.classList.add('hit-outside');
            }
            
            choiceButtons.style.display = 'none';
            setTimeout(() => {
                nextBtn.style.display = 'inline-block';
            }, 600);
        }
        
        onTopicBtn.addEventListener('click', showResult);
        offTopicBtn.addEventListener('click', showResult);
        nextBtn.addEventListener('click', () => { currentScenarioIndex++; loadScenario(); });
        restartBtn.addEventListener('click', () => {
            currentScenarioIndex = 0;
            completedParts.clear();
            introButtons.forEach(button => button.classList.remove('completed'));
            document.querySelectorAll('.body-part-icon').forEach(icon => icon.classList.remove('visible'));
            cueBox.innerHTML = '<p>Click a button to begin!</p>';
            exampleBox.classList.remove('visible');
            exampleBox.innerHTML = '';
            startButton.style.display = 'none';
            introScreen.style.display = 'block';
            gameScreen.style.display = 'none';
            restartBtn.style.display = 'none';
        });
    </script>
</body>
</html>
